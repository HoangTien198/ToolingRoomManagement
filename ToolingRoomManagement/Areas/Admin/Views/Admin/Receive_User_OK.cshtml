@model List<Model.EF.Receive>

@{
    ViewBag.Title = "Receive_User_OK";
    Layout = "~/Areas/Admin/Views/Shared/_Layout_AdminPage.cshtml";
    int dem = 0;
}

<style>
    @@media (min-width: 900px) {
        .modal-sm {
            width: 900px;
        }
    }

    @@media (min-width: 900px) {
        .modal-content {
            -webkit-box-shadow: 0 5px 15px rgba(0,0,0,.5);
            box-shadow: 0 5px 15px rgba(0,0,0,.5);
        }
    }

    .tblCreate thead tr th {
        text-align: center;
    }

    .tblCreate tbody tr td {
        text-align: center;
    }

    .project-list {
        display: -webkit-box;
        display: flex;
        flex-wrap: wrap;
        padding-bottom: 3rem;
    }

    .project-item {
        width: 33.333%;
        padding: .5rem;
        -webkit-transition: 400ms ease;
        transition: 400ms ease;
    }

        .project-item .item-inner {
            padding-bottom: 0;
            border-radius: 5px;
            background: #152036;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.32);
            -webkit-transition: 400ms;
            transition: 400ms;
        }

    .item-inner .content {
        padding: 1.5rem;
    }

        .item-inner .content h3 {
            margin-top: 0;
            color: #84bf7d;
        }

        .item-inner .content p {
            margin-bottom: 1rem;
            color: #ecece7;
        }

    .item-inner .item-footer {
        display: flex;
        -webkit-box-pack: justify;
        justify-content: space-between;
        padding: .75rem;
        padding-bottom: .25rem;
        background: #1c2f52;
        border-top: 1px solid #ddd;
        color: #f3ebeb;
        border-bottom-left-radius: 5px;
        border-bottom-right-radius: 5px;
    }

    }

    .item-inner .item-footer .item-person {
        position: relative;
        top: -4px;
    }

        .item-inner .item-footer .item-person img {
            height: 1.75rem;
            width: 1.75rem;
            border-radius: 50%;
        }

        .item-inner .item-footer .item-person span {
            margin-left: .5rem;
        }

    .item-inner .item-footer .date {
        position: relative;
        top: 3px;
        margin: 0;
    }

        .item-inner .item-footer .date h5 {
            margin: 0;
        }

    .zoom {
        transition: transform .5s;
    }

        .zoom:hover {
            transform: scale(1.1); /* (150% zoom - Note: if the zoom is too large, it will go outside of the viewport) */
        }

    .close_reject {
        margin-top: -2px;
    }

    .close_reject {
        padding: 0;
        cursor: pointer;
        background: 0 0;
        border: 0;
    }

    .close_reject {
        float: right;
        font-size: 21px;
        font-weight: 700;
        line-height: 1;
        color: #000;
        text-shadow: 0 1px 0 #fff;
        filter: alpha(opacity=20);
        opacity: .2;
    }
</style>
<div class="header-advance-area">

    <!-- Mobile Menu start -->
    <div class="mobile-menu-area">
        <div class="container">
            @*<div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <div class="mobile-menu">
                            <nav id="dropdown">
                                <ul class="mobile-menu-nav">
                                    <li>
                                        <a data-toggle="collapse" data-target="#Charts" href="#">Home <span class="admin-project-icon nalika-icon nalika-down-arrow"></span></a>
                                        <ul class="collapse dropdown-header-top">
                                            <li><a href="index.html">Dashboard v.1</a></li>
                                            <li><a href="index-1.html">Dashboard v.2</a></li>
                                            <li><a href="index-3.html">Dashboard v.3</a></li>
                                            <li><a href="product-list.html">Product List</a></li>
                                            <li><a href="product-edit.html">Product Edit</a></li>
                                            <li><a href="product-detail.html">Product Detail</a></li>
                                            <li><a href="product-cart.html">Product Cart</a></li>
                                            <li><a href="product-payment.html">Product Payment</a></li>
                                            <li><a href="analytics.html">Analytics</a></li>
                                            <li><a href="widgets.html">Widgets</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        <a data-toggle="collapse" data-target="#demo" href="#">Mailbox <span class="admin-project-icon nalika-icon nalika-down-arrow"></span></a>
                                        <ul id="demo" class="collapse dropdown-header-top">
                                            <li>
                                                <a href="mailbox.html">Inbox</a>
                                            </li>
                                            <li>
                                                <a href="mailbox-view.html">View Mail</a>
                                            </li>
                                            <li>
                                                <a href="mailbox-compose.html">Compose Mail</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li>
                                        <a data-toggle="collapse" data-target="#others" href="#">Miscellaneous <span class="admin-project-icon nalika-icon nalika-down-arrow"></span></a>
                                        <ul id="others" class="collapse dropdown-header-top">
                                            <li><a href="file-manager.html">File Manager</a></li>
                                            <li><a href="contacts.html">Contacts Client</a></li>
                                            <li><a href="projects.html">Project</a></li>
                                            <li><a href="project-details.html">Project Details</a></li>
                                            <li><a href="blog.html">Blog</a></li>
                                            <li><a href="blog-details.html">Blog Details</a></li>
                                            <li><a href="404.html">404 Page</a></li>
                                            <li><a href="500.html">500 Page</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        <a data-toggle="collapse" data-target="#Miscellaneousmob" href="#">Interface <span class="admin-project-icon nalika-icon nalika-down-arrow"></span></a>
                                        <ul id="Miscellaneousmob" class="collapse dropdown-header-top">
                                            <li>
                                                <a href="google-map.html">Google Map</a>
                                            </li>
                                            <li>
                                                <a href="data-maps.html">Data Maps</a>
                                            </li>
                                            <li>
                                                <a href="pdf-viewer.html">Pdf Viewer</a>
                                            </li>
                                            <li>
                                                <a href="x-editable.html">X-Editable</a>
                                            </li>
                                            <li>
                                                <a href="code-editor.html">Code Editor</a>
                                            </li>
                                            <li>
                                                <a href="tree-view.html">Tree View</a>
                                            </li>
                                            <li>
                                                <a href="preloader.html">Preloader</a>
                                            </li>
                                            <li>
                                                <a href="images-cropper.html">Images Cropper</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li>
                                        <a data-toggle="collapse" data-target="#Chartsmob" href="#">Charts <span class="admin-project-icon nalika-icon nalika-down-arrow"></span></a>
                                        <ul id="Chartsmob" class="collapse dropdown-header-top">
                                            <li>
                                                <a href="bar-charts.html">Bar Charts</a>
                                            </li>
                                            <li>
                                                <a href="line-charts.html">Line Charts</a>
                                            </li>
                                            <li>
                                                <a href="area-charts.html">Area Charts</a>
                                            </li>
                                            <li>
                                                <a href="rounded-chart.html">Rounded Charts</a>
                                            </li>
                                            <li>
                                                <a href="c3.html">C3 Charts</a>
                                            </li>
                                            <li>
                                                <a href="sparkline.html">Sparkline Charts</a>
                                            </li>
                                            <li>
                                                <a href="peity.html">Peity Charts</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li>
                                        <a data-toggle="collapse" data-target="#Tablesmob" href="#">Tables <span class="admin-project-icon nalika-icon nalika-down-arrow"></span></a>
                                        <ul id="Tablesmob" class="collapse dropdown-header-top">
                                            <li>
                                                <a href="static-table.html">Static Table</a>
                                            </li>
                                            <li>
                                                <a href="data-table.html">Data Table</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li>
                                        <a data-toggle="collapse" data-target="#formsmob" href="#">Forms <span class="admin-project-icon nalika-icon nalika-down-arrow"></span></a>
                                        <ul id="formsmob" class="collapse dropdown-header-top">
                                            <li>
                                                <a href="basic-form-element.html">Basic Form Elements</a>
                                            </li>
                                            <li>
                                                <a href="advance-form-element.html">Advanced Form Elements</a>
                                            </li>
                                            <li>
                                                <a href="password-meter.html">Password Meter</a>
                                            </li>
                                            <li>
                                                <a href="multi-upload.html">Multi Upload</a>
                                            </li>
                                            <li>
                                                <a href="tinymc.html">Text Editor</a>
                                            </li>
                                            <li>
                                                <a href="dual-list-box.html">Dual List Box</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li>
                                        <a data-toggle="collapse" data-target="#Appviewsmob" href="#">App views <span class="admin-project-icon nalika-icon nalika-down-arrow"></span></a>
                                        <ul id="Appviewsmob" class="collapse dropdown-header-top">
                                            <li>
                                                <a href="basic-form-element.html">Basic Form Elements</a>
                                            </li>
                                            <li>
                                                <a href="advance-form-element.html">Advanced Form Elements</a>
                                            </li>
                                            <li>
                                                <a href="password-meter.html">Password Meter</a>
                                            </li>
                                            <li>
                                                <a href="multi-upload.html">Multi Upload</a>
                                            </li>
                                            <li>
                                                <a href="tinymc.html">Text Editor</a>
                                            </li>
                                            <li>
                                                <a href="dual-list-box.html">Dual List Box</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li>
                                        <a data-toggle="collapse" data-target="#Pagemob" href="#">Pages <span class="admin-project-icon nalika-icon nalika-down-arrow"></span></a>
                                        <ul id="Pagemob" class="collapse dropdown-header-top">
                                            <li>
                                                <a href="login.html">Login</a>
                                            </li>
                                            <li>
                                                <a href="register.html">Register</a>
                                            </li>
                                            <li>
                                                <a href="lock.html">Lock</a>
                                            </li>
                                            <li>
                                                <a href="password-recovery.html">Password Recovery</a>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>*@
        </div>
    </div>
    <!-- Mobile Menu end -->
    <div class="breadcome-area" style=" margin-top: 40px;">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div class="breadcome-list">
                        <div class="row">
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                <div class="breadcomb-wp">
                                    <div class="breadcomb-icon zoom" data-toggle="tooltip" data-placement="bottom" title="Home">
                                        <a href="/Admin/Admin/Index">
                                            <i class="icon nalika-home"></i>
                                        </a>
                                    </div>
                                    <div class="breadcomb-ctn">
                                        <h2>All Devices</h2>
                                        <p>Welcome to Tooling <span class="bread-ntd">Room</span></p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                <div class="breadcomb-report">
                                    <button data-toggle="tooltip" data-placement="left" title="Download Report" class="btn"><i class="icon nalika-download"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="product-sales-area mg-tb-30" style="">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="height:740px;">
                <div class="product-sales-chart" style="height:710px;">
                    <div class="portlet-title">
                        <div class="row">
                            <div class="content">
                                <div class="" style="margin-left:50px;">
                                    <div class="project-list">
                                        @if (Model.Count() != 0)
                                        {
                                            foreach (var receive in Model)
                                            {
                                                { dem++; }
                                                <a class="project-item zoom" onclick="deltail('@receive.id','@receive.code_receive.Substring(0,1)')">
                                                    <div class="item-inner">
                                                        <div class="content">
                                                            <h3>Receive @dem: @receive.code_receive</h3>
                                                            <p>@receive.receive_name</p>
                                                        </div>
                                                        <div class="item-footer">
                                                            <div class="date">
                                                                <h5>@receive.create_date.Value.ToString("dd/MM/yyyy")</h5>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </a>
                                            }
                                        }
                                        else
                                        {
                                            <h4 style="color:#fff">Dont have any Receive!</h4>
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

        </div>
    </div>
</div>
<!-- The Modal -->
<div class="modal" id="myModal">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Detail Order</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body">
                <input hidden id="receive_id" />
                <table class="table table-dark tblCreate">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>Tên TB</th>
                            <th>Kho</th>
                            <th>Số lượng</th>
                            <th>Type</th>
                            <th>Ghi chú</th>
                        </tr>
                    </thead>
                    <tbody id="tblReceive" style="text-align:center;"></tbody>
                </table>
            </div>

            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary btnclose">Close</button>
                @*<button type="button" style="background: green;color: white;" class="btn btn-secondary" onclick="confirm()">Confirm</button>
                    <button type="button" style="background: red;color: white;" class="btn btn-secondary btnreject" onclick="open_reject()">Reject</button>*@
            </div>

        </div>
    </div>
</div>
<div class="modal" id="ModalDeviceBackRoom">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Chi tiết</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body">
                <input hidden id="receive_id" />

                <table class="" style="border:0;margin-left: 60px;" id="tblBack">
                    <tr>
                        <td style="width: 150px;height: 50px;">Mã Kiểm kê: </td>
                        <td class="makiemke"></td>
                    </tr>
                    <tr>
                        <td style="width: 150px;height: 50px;">Mã SN: </td>
                        <td class="maSN"></td>
                    </tr>
                    <tr>
                        <td style="width: 150px;height: 50px;">Tên TB: </td>
                        <td class="tenTB"></td>
                    </tr>
                    <tr>
                        <td style="width: 150px;height: 50px;">Model: </td>
                        <td class="model_TB"></td>
                    </tr>
                    <tr>
                        <td style="width: 150px;height: 50px;">Mã Hiệu chuẩn: </td>
                        <td class="mahieuchuan"></td>
                    </tr>
                    <tr>
                        <td style="width: 150px;height: 50px;">Nhập vào kho : </td>
                        <td class="kho_TB"></td>
                    </tr>
                    <tr>
                        <td style="width: 150px;height: 50px;">Tình trạng TB: </td>
                        <td class="statusTB"></td>
                    </tr>
                    <tr>
                        <td style="width: 150px;height: 50px;">Ghi chú: </td>
                        <td class="noteTB"></td>
                    </tr>
                    <tr class="image_TB">
                        <td style="width: 150px;height: 50px;">Hình ảnh: </td>
                        <td class="imageTB">
                            @*<input type="file" class="form-control TYPEDEVICE" style="background-color:white;color:black;border: 1px solid #5c7096;border-radius: 21px;" id="imageTB" multiple>*@

                        </td>
                    </tr>


                </table>

            </div>

            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary btnclose">Đóng</button>
                <button type="button" class="btn btn-secondary btnAdd" @*onclick="CreateReceive()"*@>Cập nhật</button>

            </div>

        </div>
    </div>
</div>
<script src="/Assets/admin/js/vendor/jquery-1.12.4.min.js"></script>
<script>
    var modal = document.getElementById("myModal");
    var modalDeviceBackRoom = document.getElementById("ModalDeviceBackRoom");
    $(document).on("click", ".close", function () {
        modal.style.display = "none";
    })
    $(document).on("click", ".btnclose", function () {
        modal.style.display = "none";
    })
    function deltail(receive_id, code_receive) {
        $(".imageTB").empty();
        if (code_receive == "R") {
            $("#tblReceive").empty();
            $.ajax({
                type: "Post",
                url: "/Receive/get_Output_Receive?receive_id=" + receive_id,
                async: false,
                contentType: false,
                processData: false,
                success: function (data) {
                    //alert(data);
                    debugger
                    var length = JSON.parse(data).length;
                    var row = "";
                    //if (length == 0) {
                    //    alert("Dont have any device!");
                    //    return;
                    //}
                    for (i = 0; i < length; i++) {
                        var type = "";
                        if (JSON.parse(data)[i].output.type == 1) {
                            type = "Receive";
                        } else if (JSON.parse(data)[i].output.type == 2) {
                            type = "Change";
                        } else {
                            type = "Borrow";
                        }
                        var note = "";
                        if (JSON.parse(data)[i].output.note != null) {
                            note = JSON.parse(data)[i].output.note;
                        }
                        else {
                            note = "";
                        }
                        var confirm = "'" + JSON.parse(data)[i].output.quantity_output + "','" + JSON.parse(data)[i].output.device_id + "','" + JSON.parse(data)[i].output.receive_id + "','" + JSON.parse(data)[i].output.id + "','" + JSON.parse(data)[i].output.type + "','" + JSON.parse(data)[i].output.unit + "','" + "','" + note + "'";
                        row = row + '<tr>' +
                            '<td>' + (i + 1) + '</td>' +
                            '<td>' + JSON.parse(data)[i].device_name + '</td>' +
                            '<td>' + JSON.parse(data)[i].location + '</td>' +
                            '<td class="quantity">' + JSON.parse(data)[i].output.quantity_output + '</td>' +
                            '<td>' + type + '</td>' +
                            '<td>' + note + '</td>' +
                            '</tr>';
                    }
                    $("#receive_id").val(receive_id);
                    $("#tblReceive").append(row);
                    modal.style.display = "block";
                },
                error: function (err) {
                    //debugger
                    alert("FAIL!");
                }
            });
        } else if (code_receive == "I") {
            $.ajax({
                type: "Post",
                url: "/Device/get_DeviceBackRoom?receive_id=" + receive_id,
                async: false,
                contentType: false,
                processData: false,
                success: function (data) {
                    //alert(data);
                    //debugger
                    var row = "";
                    $(".makiemke").append("<div>" + JSON.parse(data).makiemke + "</div>");
                    $(".maSN").append("<div>" + JSON.parse(data).produce_SN + "</div>");
                    $(".tenTB").append("<div>" + JSON.parse(data).device_name + "</div>");
                    $(".model_TB").append("<div>" + JSON.parse(data).parameter + "</div>");
                    var a = "";
                    if (JSON.parse(data).calibration != null) {
                        a = JSON.parse(data).calibration;
                    } else {
                        a = "N/A";
                    }
                    $(".mahieuchuan").append("<div>" + a + "</div>");
                    $(".kho_TB").append("<div>" + JSON.parse(data).location + "</div>");
                    if (JSON.parse(data).status == 1) {
                        $(".statusTB").append("<div>OK</div>");
                    } else {
                        $(".statusTB").append("<div>NG</div>");
                    }
                    $(".noteTB").val(JSON.parse(data).note_status);
                    if (JSON.parse(data).imageTB != null) {
                        $(".imageTB").append("<div>Không có hình ảnh nào!</div>");
                    } else {
                        debugger
                        var image_ = JSON.parse(JSON.parse(data).image_TB);
                        var list_image = "";
                        for (j = 0; j < image_.length; j++) {
                            list_image += '<a href="/Data/Image/' + image_[j].file + '" data-toggle="lightbox" data-max-width="600" >' +
                                '   <img style="width:150px;height:100px;border: 1px solid #2c303a" src="/Data/Image/' + image_[j].file + '" class="img-fluid">' +
                                '</a>';
                        }
                        $(".imageTB").append(list_image);
                    }
                    modalDeviceBackRoom.style.display = "block";
                },
                error: function (err) {
                    //debugger
                    alert("FAIL!");
                }
            });
        }
    }

</script>

