@model IEnumerable<ToolingRoomManagement.Models.Device_ManagerModel>
@{
    ViewBag.Title = "UserPage";
    Layout = "~/Areas/Admin/Views/Shared/_Layout_AdminPage.cshtml";
    var listAllDevice = (List<Model.EF.Device>)ViewBag.listAllDevice;
    var listAllManager = (List<Model.EF.User>)ViewBag.ListAllManager;
    var listDeviceManager = (List<Model.EF.Device>)ViewBag.ListDevice_Manager;
    int dem = 0; int dem2 = 0; int dem3 = 0; int dem1 = 0; int dem4 = 0;
    int all = 0;
    int kind1 = 0;
    int kind2 = 0;
    int kind3 = 0;
    int kind4 = 0;
    float _kind1 = 0;
    float _kind2 = 0;
    float _kind3 = 0;
    float _kind4 = 0;
}
<link href="~/Assets/admin/bootstrap-select.css" rel="stylesheet" />
@*<script src="~/Assets/client/vendor/jquery/jquery.min.js"></script>*@
<script src="~/Assets/admin/js/vendor/jquery-1.12.4.min.js"></script>
<script src="~/Assets/admin/bootstrap-select.js"></script>
@foreach (var item in listAllDevice)
{
    { all++; }
    if (item.kind_of_device == 1)
    {
        { kind1 = kind1 + 1; }
    }
    else if (item.kind_of_device == 2)
    {
        { kind2 = kind2 + 1; }
    }
    else if (item.kind_of_device == 3)
    {
        { kind3 = kind3 + 1; }
    }
    else
    {
        { kind4 = kind4 + 1; }
    }
}
@{
    _kind1 = (float.Parse(kind1.ToString()) / float.Parse(all.ToString())) * 100;
    _kind2 = (float.Parse(kind2.ToString()) / float.Parse(all.ToString())) * 100;
    _kind3 = (float.Parse(kind3.ToString()) / float.Parse(all.ToString())) * 100;
    _kind4 = (float.Parse(kind4.ToString()) / float.Parse(all.ToString())) * 100;
}
<style>
    h6 {
        color: aliceblue;
    }

        h6 b {
            font-weight: 700;
        }

    @@media (min-width: 1000px) {
        .modal-sm {
            width: 1200px;
        }
    }

    @@media (min-width: 1200px) {
        .modal-content {
            -webkit-box-shadow: 0 5px 15px rgba(0,0,0,.5);
            box-shadow: 0 5px 15px rgba(0,0,0,.5);
        }
    }

    .tblCreate thead tr th {
        text-align: center;
    }

    .tblCreate tbody tr td {
        text-align: center;
    }

    #tblAddReceive {
        width: 80%;
        margin-left: 65px;
    }

        #tblAddReceive tbody tr {
            height: 50px;
        }

    .dropdown-toggle {
        height: 40px;
    }

    #tblAddDevice thead tr th {
        text-align: center;
    }

    #tblAddDevice tbody tr td {
        text-align: center;
    }

    .Da_select_model {
        width: 98%;
    }

    .zoom {
        transition: transform .5s;
    }

        .zoom:hover {
            transform: scale(1.1); /* (150% zoom - Note: if the zoom is too large, it will go outside of the viewport) */
        }

    .btn-default {
        height: 43px;
    }

    .tblCreate tbody tr td {
        height: 60px;
    }

    ::-webkit-scrollbar {
        width: 5px;
        height: 5px;
    }

    ::-webkit-scrollbar-thumb {
        -webkit-box-shadow: inset 0 0 4px 9px rgba(0,0,0,0.3);
        border-radius: 10px;
    }

    @@keyframes example {
        0% {
            background-color: red;
        }

        25% {
            background-color: #1b2a47;
        }

        50% {
            background-color: red;
        }

        75% {
            background-color: #1b2a47;
        }

        100% {
            background-color: red;
        }
    }

    .animation {
        background-color: red;
        position: relative;
        animation-name: example;
        animation-duration: 4s;
        animation-iteration-count: infinite;
    }

    .tblShow {
        border: 1px solid;
    }

        .tblShow thead tr th {
            vertical-align: middle;
            background: #2d9aca;
            padding: 0px 0px 0px 5px;
            position: sticky;
            top: -3px;
        }

        .tblShow tbody tr td {
            vertical-align: middle;
            padding: 6px 15px;
        }

    #tbl thead tr th {
        background: #5c7096;
        position: sticky;
        top: -3px;
    }

    #tbl1 thead tr th {
        background: #5c7096;
        position: sticky;
        top: -3px;
    }

    #tbl2 thead tr th {
        background: #5c7096;
        position: sticky;
        top: -3px;
    }

    #tbl3 thead tr th {
        background: #5c7096;
        position: sticky;
        top: -3px;
    }

    #tbl4 thead tr th {
        background: #5c7096;
        position: sticky;
        top: -3px;
    }

    .form-control {
        background: white;
        color: black;
    }

    #tblBack tbody tr td {
        text-align: center;
    }
    #table_View_Back thead tr th{
        position:sticky;
        top:-3px;
        background:wheat;
    }
</style>
<div class="header-advance-area">

    <!-- Mobile Menu start -->
    <div class="mobile-menu-area">
        <div class="container">

        </div>
    </div>
    <!-- Mobile Menu end -->
    <div class="breadcome-area" style="margin-top: 40px;">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div class="breadcome-list" style="padding: 10px 20px 10px 20px;margin: 30px 0px 10px 0px;" onclick="show_table('tbl')">
                        <div class="row">
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                <div class="breadcomb-wp">
                                    <div class="breadcomb-icon zoom" data-toggle="tooltip" data-placement="bottom" title="Home">
                                        <a href="/Admin/Admin/UserPage"><i class="icon nalika-home"></i></a>
                                    </div>
                                    <div class="breadcomb-ctn">
                                        <h2 langKey="all_device">Tất cả TB</h2>
                                        <p>Welcome to Tooling <span class="bread-ntd">Room</span></p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                <div class="breadcomb-report">
                                    <button data-toggle="tooltip" data-placement="left" title="Xuất Excel" class="btn" onclick="fnExcelReport()"><i class="icon nalika-download"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="section-admin container-fluid">
        <div class="row admin text-center">
            <div class="col-md-12">
                <div class="row">
                    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                        <div class="admin-content analysis-progrebar-ctn res-mg-t-15" onclick="show_table('tbl1')" style="padding: 10px 20px 10px 20px;">
                            <h6 class="text-left text-uppercase"><b langKey="fix_device">Thiết bị cố định</b></h6>
                            <div class="row vertical-center-box vertical-center-box-tablet">
                                <div class="col-xs-3 mar-bot-15 text-left">
                                    <label class="label bg-green" id="_kind1">@string.Format("{0:N2}", _kind1) % <i class="fa fa-level-up" aria-hidden="true"></i></label>
                                </div>
                                <div class="col-xs-9 cus-gh-hd-pro">
                                    <h2 class="text-right no-margin" id="kind1">@kind1</h2>
                                </div>
                            </div>
                            <div class="progress progress-mini">
                                <div style="width: @string.Format("{0:N2}", _kind1)%" class="progress-bar bg-green"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                        <div class="admin-content analysis-progrebar-ctn res-mg-t-30" onclick="show_table('tbl2')" style="padding: 10px 20px 10px 20px;">
                            <h6 class="text-left text-uppercase"><b langKey="consum_device">Thiết bị tiêu hao</b></h6>
                            <div class="row vertical-center-box vertical-center-box-tablet">
                                <div class="text-left col-xs-3 mar-bot-15">
                                    <label class="label bg-blue">@string.Format("{0:N2}", _kind2) % <i class="fa fa-level-up" aria-hidden="true"></i></label>
                                </div>
                                <div class="col-xs-9 cus-gh-hd-pro">
                                    <h2 class="text-right no-margin">@kind2</h2>
                                </div>
                            </div>
                            <div class="progress progress-mini">
                                <div style="width: @string.Format("{0:N2}", _kind2)%;" class="progress-bar bg-blue"></div>
                            </div>
                        </div>
                    </div>
                    @*<div class="col-lg-3 col-md-3 col-sm-3 col-xs-12">
                            <div class="admin-content analysis-progrebar-ctn res-mg-t-30" onclick="show_table('tbl3')" style="padding: 10px 20px 10px 20px;">
                                <h6 class="text-left text-uppercase"><b>Thiết bị hao trái</b></h6>
                                <div class="row vertical-center-box vertical-center-box-tablet">
                                    <div class="text-left col-xs-3 mar-bot-15">
                                        <label class="label bg-purple">@string.Format("{0:N2}", _kind3) % <i class="fa fa-level-up" aria-hidden="true"></i></label>
                                    </div>
                                    <div class="col-xs-9 cus-gh-hd-pro">
                                        <h2 class="text-right no-margin">@kind3</h2>
                                    </div>
                                </div>
                                <div class="progress progress-mini">
                                    <div style="width: @string.Format("{0:N2}", _kind3)%;" class="progress-bar bg-purple"></div>
                                </div>
                            </div>
                        </div>*@
                    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12" style="margin-bottom:1px;">
                        <div class="admin-content analysis-progrebar-ctn res-mg-t-30" onclick="show_table('tbl3')" style="padding: 10px 20px 10px 20px;">
                            <h6 class="text-left text-uppercase"><b langKey="reserve_device">Thiết bị dự phòng</b></h6>
                            <div class="row vertical-center-box vertical-center-box-tablet">
                                <div class="text-left col-xs-3 mar-bot-15">
                                    <label class="label bg-red">@string.Format("{0:N2}", _kind3) % <i class="fa fa-level-down" aria-hidden="true"></i></label>
                                </div>
                                <div class="col-xs-9 cus-gh-hd-pro">
                                    <h2 class="text-right no-margin">@kind3</h2>
                                </div>
                            </div>
                            <div class="progress progress-mini">
                                <div style="width: @string.Format("{0:N2}", _kind3)%;" class="progress-bar progress-bar-danger bg-red"></div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

</div>
<div class="product-sales-area mg-tb-30" style="margin: 10px 0px;">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="product-sales-chart" style="padding: 5px 10px 5px 20px;">
                    <div class="portlet-title">
                        <div class="row">
                            <div style="width:33.33%;float:left;height: 280px;">
                                <div style="padding: 5px 26px 5px 10px;overflow:auto;">
                                    <div style="overflow:auto;height: 277px;">
                                        <table class="tblShow table-bordered" style="width: 100%;color:white;">
                                            <thead>
                                                <tr style="height:45px;">
                                                    <th style="width:80%;" langKey="name_device">Device name</th>
                                                    <th langKey="quantity">Quantity</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @if (listAllDevice.Count() != 0)
                                                {
                                                    foreach (var item in listAllDevice)
                                                    {
                                                        if (item.kind_of_device == 1)
                                                        {
                                                            if (item.quantity <= item.gioihan)
                                                            {
                                                                <tr class="animation" style="background-color: #e6333394">
                                                                    <td>@item.device_name</td>
                                                                    <td>@item.quantity</td>
                                                                </tr>
                                                            }
                                                            else
                                                            {
                                                                <tr>
                                                                    <td>@item.device_name</td>
                                                                    <td>@item.quantity</td>
                                                                </tr>
                                                            }

                                                        }
                                                    }
                                                }

                                            </tbody>


                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div style="width:33.33%;float:left;height: 280px;">
                                <div style="padding: 5px 18px 5px 4px;overflow:auto;">
                                    <div style="overflow:auto;height: 277px;">
                                        <table class="tblShow table-bordered" style="width: 100%; color:white;">
                                            <thead>
                                                <tr style="height:45px;">
                                                    <th style="width:80%;" langKey="name_device">Device name</th>
                                                    <th langKey="quantity">Quantity</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach (var item in listAllDevice)
                                                {
                                                    if (item.kind_of_device == 2)
                                                    {
                                                        if (item.quantity <= item.gioihan)
                                                        {
                                                            <tr class="animation" style="background-color: #e6333394">
                                                                <td>@item.device_name</td>
                                                                <td>@item.quantity</td>
                                                            </tr>
                                                        }
                                                        else
                                                        {
                                                            <tr>
                                                                <td>@item.device_name</td>
                                                                <td>@item.quantity</td>
                                                            </tr>
                                                        }
                                                    }
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            @*<div style="width:25%;float:left;height: 280px;">
                                    <div style="padding: 5px 10px 5px 10px;overflow:auto;">
                                        <div style="overflow:auto;height: 277px;">
                                            <table class="tblShow table-bordered" style="width: 100%;color:white;">
                                                <thead>
                                                    <tr style="height:45px;">
                                                        <th style="width:80%;">Device name</th>
                                                        <th>Quantity</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @foreach (var item in listDeviceManager)
                                                    {
                                                        if (item.kind_of_device == 3)
                                                        {
                                                            if (item.quantity < 5)
                                                            {
                                                                <tr class="animation" style="background-color: #e6333394">
                                                                    <td>@item.device_name</td>
                                                                    <td>@item.quantity</td>
                                                                </tr>
                                                            }
                                                            else
                                                            {
                                                                <tr>
                                                                    <td>@item.device_name</td>
                                                                    <td>@item.quantity</td>
                                                                </tr>
                                                            }
                                                        }
                                                    }
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>*@
                            <div style="width:33.33%;float:left;height: 280px;">
                                <div style="padding: 5px 10px 5px 20px;overflow:auto;">
                                    <div style="overflow:auto;height: 277px;">
                                        <table class="tblShow table-bordered" style="width: 100%;color:white;">
                                            <thead>
                                                <tr style="height:45px;">
                                                    <th style="width:80%;" langKey="name_device">Device name</th>
                                                    <th langKey="quantity">Quantity</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach (var item in listAllDevice)
                                                {
                                                    if (item.kind_of_device == 3)
                                                    {
                                                        if (item.quantity <= item.gioihan)
                                                        {
                                                            <tr class="animation" style="background-color: #e6333394">
                                                                <td>@item.device_name</td>
                                                                <td>@item.quantity</td>
                                                            </tr>
                                                        }
                                                        else
                                                        {
                                                            <tr>
                                                                <td>@item.device_name</td>
                                                                <td>@item.quantity</td>
                                                            </tr>
                                                        }
                                                    }
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="product-sales-area mg-tb-30" style="height: 70vh;">
    <div class="container-fluid" style="height: 70vh;">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="product-sales-chart" style="padding: 6px 20px 5px 20px;">
                    <div class="portlet-title">
                        <div class="row">
                            <div class="content">
                                <div>
                                    <button class="zoom" style="border: 1px solid #f39800;background-color: #f39800;width: 110px;height: 40px;border-radius: 5px;" onclick="open_Modal_Create()">Tạo đơn</button>
                                    <div class="col-lg-2 col-md-7 col-sm-6 col-xs-12" style="float:right;width: 300px;">
                                        <div class="header-top-menu tabl-d-n hd-search-rp">
                                            <div class="breadcome-heading" style="margin: 0px 0px 10px 0px;">
                                                <form role="search" class="">
                                                    <input id="input_search" type="text" placeholder="Search..." class="form-control" style="width: 283px;color: #fffaf0;height: 39px;">
                                                    <a href="" style="left: 257px;margin-top: -23px;"><i class="fa fa-search"></i></a>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="" style="overflow:auto;height: 60vh;width:100%;">
                                    <table id="tbl" class="table table-bordered" style="color:floralwhite;text-align:center;">
                                        <thead style="background:#5c7096;">
                                            <tr>
                                                <th scope="col" style="text-align:center;">STT</th>
                                                <th scope="col" style="text-align:center;width: 6.2%;" langKey="code_device">Mã TB</th>
                                                <th scope="col" style="text-align:center; width:14%" langKey="name_device">Tên TB</th>
                                                <th scope="col" style="text-align:center; width:4%" langKey="quantity">Số lượng</th>
                                                <th scope="col" style="text-align:center; width:4%;" langKey="price_device">Giá</th>
                                                <th scope="col" style="text-align:center; width:4%;" langKey="model_device">Nhãn hiệu</th>
                                                <th scope="col" style="text-align:center;width:14%;" langKey="parameter">Quy cách</th>
                                                <th scope="col" style="text-align:center;" langKey="unit">Đơn vị</th>
                                                <th scope="col" style="text-align:center;" langKey="location">Vị trí</th>
                                                <th scope="col" style="text-align:center;" langKey="status_1">TT</th>
                                                <th scope="col" style="text-align:center; width:5%;" langKey="inventory_stamp">Kiểm kê</th>
                                                <th scope="col" style="text-align:center;" langKey="SN_code">SN</th>
                                                <th scope="col" style="text-align:center; width:5%;" langKey="calibration">Hiệu chỉnh</th>
                                                <th scope="col" style="text-align:center; width:6%;" langKey="create_date">Ngày nhập</th>
                                                <th scope="col" style="text-align:center;width:6%;" langKey="update_date">Ngày update</th>
                                                <th scope="col" style="text-align:center;width:4%;" langKey="kindOfDevice">Loại TB</th>
                                                <th scope="col" style="text-align:center;width:4%;" langKey="manager">Quản lý</th>
                                                <th scope="col" style="text-align:center;width:4%;" langKey="image">Hình ảnh</th>

                                            </tr>
                                        </thead>
                                        <tbody id="tbl_id">
                                            @foreach (var device in Model)
                                            {
                                                { dem++; }
                                                if (device.device.quantity <= device.device.gioihan)
                                                {
                                                    <tr class="animation" style="background-color:#e6333394;">

                                                        <td scope="row">@dem</td>
                                                        <td>@device.device.code_device</td>
                                                        <td style="text-align:left;">@device.device.device_name</td>
                                                        <td>@device.device.quantity</td>
                                                        <td>@device.device.price</td>
                                                        <td>@(device.device.brand != null ? device.device.brand.Trim() : "N/A")</td>

                                                        <td>@device.device.parameter</td>

                                                        <td>@(device.device.unit != null ? device.device.unit.Trim() : "N/A")</td>

                                                        <td>@(device.device.location != null ? device.device.location.Trim() : "N/A")</td>

                                                        <td>@(device.device.status == 1 ? "OK" : device.device.status == 2 ? "NG" : "N/A")</td>
                                                        <td>@(device.device.makiemke != null ? device.device.makiemke.Trim() : "N/A")</td>
                                                        <td>@(device.device.produce_SN != null ? device.device.produce_SN.Trim() : "N/A")</td>
                                                        <td>@(device.device.calibration != null ? device.device.calibration.Trim() : "N/A")</td>
                                                        @if (device.device.create_date != null)
                                                        {
                                                            <td>@device.device.create_date.Value.ToString("dd/MM/yyyy")</td>
                                                        }
                                                        else
                                                        {
                                                            <td>N/A</td>
                                                        }
                                                        @if (device.device.update_date != null)
                                                        {
                                                            <td>@device.device.update_date.Value.ToString("dd/MM/yyyy")</td>
                                                        }
                                                        else
                                                        {
                                                            <td>N/A</td>
                                                        }
                                                        <td>@(device.device.kind_of_device == 1 ? "TB CĐ" : device.device.kind_of_device == 2 ? "TB TH" : device.device.kind_of_device == 3 ? "TB DP" : "N/A")</td>
                                                        <td>@device.user_name</td>
                                                        <td><button style="background: forestgreen;border: 1px solid green;border-radius: 7px;" onclick="ViewImage('@device.device.image_TB','@device.device.note_status')">Xem</button></td>

                                                    </tr>
                                                }
                                                else
                                                {
                                                    <tr>

                                                        <td scope="row">@dem</td>
                                                        <td>@device.device.code_device</td>
                                                        <td style="text-align:left;">@device.device.device_name</td>
                                                        <td>@device.device.quantity</td>
                                                        <td>@device.device.price</td>
                                                        <td>@(device.device.brand != null ? device.device.brand.Trim() : "N/A")</td>

                                                        <td>@device.device.parameter</td>

                                                        <td>@(device.device.unit != null ? device.device.unit.Trim() : "N/A")</td>

                                                        <td>@(device.device.location != null ? device.device.location.Trim() : "N/A")</td>

                                                        <td>@(device.device.status == 1 ? "OK" : device.device.status == 2 ? "NG" : "N/A")</td>
                                                        <td>@(device.device.makiemke != null ? device.device.makiemke.Trim() : "N/A")</td>
                                                        <td>@(device.device.produce_SN != null ? device.device.produce_SN.Trim() : "N/A")</td>
                                                        <td>@(device.device.calibration != null ? device.device.calibration.Trim() : "N/A")</td>
                                                        @if (device.device.create_date != null)
                                                        {
                                                            <td>@device.device.create_date.Value.ToString("dd/MM/yyyy")</td>
                                                        }
                                                        else
                                                        {
                                                            <td>N/A</td>
                                                        }
                                                        @if (device.device.update_date != null)
                                                        {
                                                            <td>@device.device.update_date.Value.ToString("dd/MM/yyyy")</td>
                                                        }
                                                        else
                                                        {
                                                            <td>N/A</td>
                                                        }
                                                        <td>@(device.device.kind_of_device == 1 ? "TB CĐ" : device.device.kind_of_device == 2 ? "TB TH" : device.device.kind_of_device == 3 ? "TB DP" : "N/A")</td>
                                                        <td>@device.user_name</td>
                                                        <td><button style="background: forestgreen;border: 1px solid green;border-radius: 7px;" onclick="ViewImage('@device.device.image_TB','@device.device.note_status')">Xem</button></td>


                                                    </tr>
                                                }
                                            }
                                        </tbody>
                                    </table>
                                    <table hidden id="tbl1" class="table table-bordered" style="color:floralwhite;text-align:center;">
                                        <thead style="background:#5c7096;">
                                            <tr>
                                                <th scope="col" style="text-align:center;">STT</th>
                                                <th scope="col" style="text-align:center;width: 6.2%;">Mã TB</th>
                                                <th scope="col" style="text-align:center; width:14%">Tên TB</th>
                                                <th scope="col" style="text-align:center; width:4%">Số lượng</th>
                                                <th scope="col" style="text-align:center; width:4%;">Giá</th>
                                                <th scope="col" style="text-align:center; width:4%;">Nhãn hiệu</th>
                                                <th scope="col" style="text-align:center;width:14%;">Quy cách</th>
                                                <th scope="col" style="text-align:center;">Đơn vị</th>
                                                <th scope="col" style="text-align:center;">Vị trí</th>
                                                <th scope="col" style="text-align:center;">TT</th>
                                                <th scope="col" style="text-align:center; width:5%;">Kiểm kê</th>
                                                <th scope="col" style="text-align:center;">SN</th>
                                                <th scope="col" style="text-align:center; width:5%;">Hiệu chỉnh</th>
                                                <th scope="col" style="text-align:center; width:6%;">Ngày nhập</th>
                                                <th scope="col" style="text-align:center;width:6%;">Ngày update</th>
                                                <th scope="col" style="text-align:center;width:4%;">Loại TB</th>
                                                <th scope="col" style="text-align:center;width:4%;">Quản lý</th>
                                                <th scope="col" style="text-align:center;width:4%;">Hình ảnh</th>

                                            </tr>
                                        </thead>
                                        <tbody id="tbl1_id">
                                            @foreach (var device in Model)
                                            {
                                                if (device.device.kind_of_device == 1)
                                                {
                                                    { dem1++; }
                                                    if (device.device.quantity <= device.device.gioihan)
                                                    {
                                                        <tr class="animation" style="background-color:#e6333394;">

                                                            <td scope="row">@dem1</td>
                                                            <td>@device.device.code_device</td>
                                                            <td style="text-align:left;">@device.device.device_name</td>
                                                            <td>@device.device.quantity</td>
                                                            <td>@device.device.price</td>
                                                            <td>@(device.device.brand != null ? device.device.brand.Trim() : "N/A")</td>

                                                            <td>@device.device.parameter</td>

                                                            <td>@(device.device.unit != null ? device.device.unit.Trim() : "N/A")</td>

                                                            <td>@(device.device.location != null ? device.device.location.Trim() : "N/A")</td>

                                                            <td>@(device.device.status == 1 ? "OK" : device.device.status == 2 ? "NG" : "N/A")</td>
                                                            <td>@(device.device.makiemke != null ? device.device.makiemke.Trim() : "N/A")</td>
                                                            <td>@(device.device.produce_SN != null ? device.device.produce_SN.Trim() : "N/A")</td>
                                                            <td>@(device.device.calibration != null ? device.device.calibration.Trim() : "N/A")</td>
                                                            @if (device.device.create_date != null)
                                                            {
                                                                <td>@device.device.create_date.Value.ToString("dd/MM/yyyy")</td>
                                                            }
                                                            else
                                                            {
                                                                <td>N/A</td>
                                                            }
                                                            @if (device.device.update_date != null)
                                                            {
                                                                <td>@device.device.update_date.Value.ToString("dd/MM/yyyy")</td>
                                                            }
                                                            else
                                                            {
                                                                <td>N/A</td>
                                                            }
                                                            <td>@(device.device.kind_of_device == 1 ? "TB CĐ" : device.device.kind_of_device == 2 ? "TB TH" : device.device.kind_of_device == 3 ? "TB DP" : "N/A")</td>
                                                            <td>@device.user_name</td>
                                                            <td><button style="background: forestgreen;border: 1px solid green;border-radius: 7px;" onclick="ViewImage('@device.device.image_TB','@device.device.note_status')">Xem</button></td>
                                                        </tr>
                                                    }
                                                    else
                                                    {
                                                        <tr>

                                                            <td scope="row">@dem1</td>
                                                            <td>@device.device.code_device</td>
                                                            <td style="text-align:left;">@device.device.device_name</td>
                                                            <td>@device.device.quantity</td>
                                                            <td>@device.device.price</td>
                                                            <td>@(device.device.brand != null ? device.device.brand.Trim() : "N/A")</td>

                                                            <td>@device.device.parameter</td>

                                                            <td>@(device.device.unit != null ? device.device.unit.Trim() : "N/A")</td>

                                                            <td>@(device.device.location != null ? device.device.location.Trim() : "N/A")</td>

                                                            <td>@(device.device.status == 1 ? "OK" : device.device.status == 2 ? "NG" : "N/A")</td>
                                                            <td>@(device.device.makiemke != null ? device.device.makiemke.Trim() : "N/A")</td>
                                                            <td>@(device.device.produce_SN != null ? device.device.produce_SN.Trim() : "N/A")</td>
                                                            <td>@(device.device.calibration != null ? device.device.calibration.Trim() : "N/A")</td>
                                                            @if (device.device.create_date != null)
                                                            {
                                                                <td>@device.device.create_date.Value.ToString("dd/MM/yyyy")</td>
                                                            }
                                                            else
                                                            {
                                                                <td>N/A</td>
                                                            }
                                                            @if (device.device.update_date != null)
                                                            {
                                                                <td>@device.device.update_date.Value.ToString("dd/MM/yyyy")</td>
                                                            }
                                                            else
                                                            {
                                                                <td>N/A</td>
                                                            }
                                                            <td>@(device.device.kind_of_device == 1 ? "TB CĐ" : device.device.kind_of_device == 2 ? "TB TH" : device.device.kind_of_device == 3 ? "TB DP" : "N/A")</td>
                                                            <td>@device.user_name</td>
                                                            <td><button style="background: forestgreen;border: 1px solid green;border-radius: 7px;" onclick="ViewImage('@device.device.image_TB','@device.device.note_status')">Xem</button></td>

                                                        </tr>
                                                    }
                                                }
                                            }
                                        </tbody>
                                    </table>
                                    <table hidden id="tbl2" class="table table-bordered" style="color:floralwhite;text-align:center;">
                                        <thead style="background:#5c7096;">
                                            <tr>
                                                <th scope="col" style="text-align:center;">STT</th>
                                                <th scope="col" style="text-align:center;width: 6.2%;">Mã TB</th>
                                                <th scope="col" style="text-align:center; width:14%">Tên TB</th>
                                                <th scope="col" style="text-align:center; width:4%">Số lượng</th>
                                                <th scope="col" style="text-align:center; width:4%;">Giá</th>
                                                <th scope="col" style="text-align:center; width:4%;">Nhãn hiệu</th>
                                                <th scope="col" style="text-align:center;width:14%;">Quy cách</th>
                                                <th scope="col" style="text-align:center;">Đơn vị</th>
                                                <th scope="col" style="text-align:center;">Vị trí</th>
                                                <th scope="col" style="text-align:center;">TT</th>
                                                <th scope="col" style="text-align:center; width:5%;">Kiểm kê</th>
                                                <th scope="col" style="text-align:center;">SN</th>
                                                <th scope="col" style="text-align:center; width:5%;">Hiệu chỉnh</th>
                                                <th scope="col" style="text-align:center; width:6%;">Ngày nhập</th>
                                                <th scope="col" style="text-align:center;width:6%;">Ngày update</th>
                                                <th scope="col" style="text-align:center;width:4%;">Loại TB</th>
                                                <th scope="col" style="text-align:center;width:4%;">Quản lý</th>
                                                <th scope="col" style="text-align:center;width:4%;">Hình ảnh</th>

                                            </tr>
                                        </thead>
                                        <tbody id="tbl2_id">
                                            @foreach (var device in Model)
                                            {
                                                if (device.device.kind_of_device == 2)
                                                {
                                                    { dem2++; }
                                                    if (device.device.quantity <= device.device.gioihan)
                                                    {
                                                        <tr class="animation" style="background-color:#e6333394;">

                                                            <td scope="row">@dem2</td>
                                                            <td>@device.device.code_device</td>
                                                            <td style="text-align:left;">@device.device.device_name</td>
                                                            <td>@device.device.quantity</td>
                                                            <td>@device.device.price</td>
                                                            <td>@(device.device.brand != null ? device.device.brand.Trim() : "N/A")</td>

                                                            <td>@device.device.parameter</td>

                                                            <td>@(device.device.unit != null ? device.device.unit.Trim() : "N/A")</td>

                                                            <td>@(device.device.location != null ? device.device.location.Trim() : "N/A")</td>

                                                            <td>@(device.device.status == 1 ? "OK" : device.device.status == 2 ? "NG" : "N/A")</td>
                                                            <td>@(device.device.makiemke != null ? device.device.makiemke.Trim() : "N/A")</td>
                                                            <td>@(device.device.produce_SN != null ? device.device.produce_SN.Trim() : "N/A")</td>
                                                            <td>@(device.device.calibration != null ? device.device.calibration.Trim() : "N/A")</td>
                                                            @if (device.device.create_date != null)
                                                            {
                                                                <td>@device.device.create_date.Value.ToString("dd/MM/yyyy")</td>
                                                            }
                                                            else
                                                            {
                                                                <td>N/A</td>
                                                            }
                                                            @if (device.device.update_date != null)
                                                            {
                                                                <td>@device.device.update_date.Value.ToString("dd/MM/yyyy")</td>
                                                            }
                                                            else
                                                            {
                                                                <td>N/A</td>
                                                            }
                                                            <td>@(device.device.kind_of_device == 1 ? "TB CĐ" : device.device.kind_of_device == 2 ? "TB TH" : device.device.kind_of_device == 3 ? "TB DP" : "N/A")</td>
                                                            <td>@device.user_name</td>
                                                            <td><button style="background: forestgreen;border: 1px solid green;border-radius: 7px;" onclick="ViewImage('@device.device.image_TB','@device.device.note_status')">Xem</button></td>

                                                        </tr>
                                                    }
                                                    else
                                                    {
                                                        <tr>

                                                            <td scope="row">@dem2</td>
                                                            <td>@device.device.code_device</td>
                                                            <td style="text-align:left;">@device.device.device_name</td>
                                                            <td>@device.device.quantity</td>
                                                            <td>@device.device.price</td>
                                                            <td>@(device.device.brand != null ? device.device.brand.Trim() : "N/A")</td>

                                                            <td>@device.device.parameter</td>

                                                            <td>@(device.device.unit != null ? device.device.unit.Trim() : "N/A")</td>

                                                            <td>@(device.device.location != null ? device.device.location.Trim() : "N/A")</td>

                                                            <td>@(device.device.status == 1 ? "OK" : device.device.status == 2 ? "NG" : "N/A")</td>
                                                            <td>@(device.device.makiemke != null ? device.device.makiemke.Trim() : "N/A")</td>
                                                            <td>@(device.device.produce_SN != null ? device.device.produce_SN.Trim() : "N/A")</td>
                                                            <td>@(device.device.calibration != null ? device.device.calibration.Trim() : "N/A")</td>
                                                            @if (device.device.create_date != null)
                                                            {
                                                                <td>@device.device.create_date.Value.ToString("dd/MM/yyyy")</td>
                                                            }
                                                            else
                                                            {
                                                                <td>N/A</td>
                                                            }
                                                            @if (device.device.update_date != null)
                                                            {
                                                                <td>@device.device.update_date.Value.ToString("dd/MM/yyyy")</td>
                                                            }
                                                            else
                                                            {
                                                                <td>N/A</td>
                                                            }
                                                            <td>@(device.device.kind_of_device == 1 ? "TB CĐ" : device.device.kind_of_device == 2 ? "TB TH" : device.device.kind_of_device == 3 ? "TB DP" : "N/A")</td>
                                                            <td>@device.user_name</td>
                                                            <td><button style="background: forestgreen;border: 1px solid green;border-radius: 7px;" onclick="ViewImage('@device.device.image_TB','@device.device.note_status')">Xem</button></td>

                                                        </tr>
                                                    }
                                                }
                                            }
                                        </tbody>
                                    </table>
                                    <table hidden id="tbl4" class="table table-bordered" style="color:floralwhite;text-align:center;">
                                        <thead style="background:#5c7096;">
                                            <tr>
                                                <th scope="col" style="text-align:center;">STT</th>
                                                <th scope="col" style="text-align:center;width: 6.2%;">Mã TB</th>
                                                <th scope="col" style="text-align:center; width:14%">Tên TB</th>
                                                <th scope="col" style="text-align:center; width:4%">Số lượng</th>
                                                <th scope="col" style="text-align:center; width:4%;">Giá</th>
                                                <th scope="col" style="text-align:center; width:4%;">Nhãn hiệu</th>
                                                <th scope="col" style="text-align:center;width:14%;">Quy cách</th>
                                                <th scope="col" style="text-align:center;">Đơn vị</th>
                                                <th scope="col" style="text-align:center;">Vị trí</th>
                                                <th scope="col" style="text-align:center;">TT</th>
                                                <th scope="col" style="text-align:center; width:5%;">Kiểm kê</th>
                                                <th scope="col" style="text-align:center;">SN</th>
                                                <th scope="col" style="text-align:center; width:5%;">Hiệu chỉnh</th>
                                                <th scope="col" style="text-align:center; width:6%;">Ngày nhập</th>
                                                <th scope="col" style="text-align:center;width:6%;">Ngày update</th>
                                                <th scope="col" style="text-align:center;width:4%;">Loại TB</th>
                                                <th scope="col" style="text-align:center;width:4%;">Quản lý</th>
                                                <th scope="col" style="text-align:center;width:4%;">Hình ảnh</th>

                                            </tr>
                                        </thead>
                                        <tbody id="tbl3_id">
                                            @foreach (var device in Model)
                                            {
                                                if (device.device.kind_of_device == 3)
                                                {
                                                    { dem3++; }
                                                    if (device.device.quantity <= device.device.gioihan)
                                                    {
                                                        <tr class="animation" style="background-color:#e6333394;">

                                                            <td scope="row">@dem3</td>
                                                            <td>@device.device.code_device</td>
                                                            <td style="text-align:left;">@device.device.device_name</td>
                                                            <td>@device.device.quantity</td>
                                                            <td>@device.device.price</td>
                                                            <td>@(device.device.brand != null ? device.device.brand.Trim() : "N/A")</td>

                                                            <td>@device.device.parameter</td>

                                                            <td>@(device.device.unit != null ? device.device.unit.Trim() : "N/A")</td>

                                                            <td>@(device.device.location != null ? device.device.location.Trim() : "N/A")</td>

                                                            <td>@(device.device.status == 1 ? "OK" : device.device.status == 2 ? "NG" : "N/A")</td>
                                                            <td>@(device.device.makiemke != null ? device.device.makiemke.Trim() : "N/A")</td>
                                                            <td>@(device.device.produce_SN != null ? device.device.produce_SN.Trim() : "N/A")</td>
                                                            <td>@(device.device.calibration != null ? device.device.calibration.Trim() : "N/A")</td>
                                                            @if (device.device.create_date != null)
                                                            {
                                                                <td>@device.device.create_date.Value.ToString("dd/MM/yyyy")</td>
                                                            }
                                                            else
                                                            {
                                                                <td>N/A</td>
                                                            }
                                                            @if (device.device.update_date != null)
                                                            {
                                                                <td>@device.device.update_date.Value.ToString("dd/MM/yyyy")</td>
                                                            }
                                                            else
                                                            {
                                                                <td>N/A</td>
                                                            }
                                                            <td>@(device.device.kind_of_device == 1 ? "TB CĐ" : device.device.kind_of_device == 2 ? "TB TH" : device.device.kind_of_device == 3 ? "TB DP" : "N/A")</td>
                                                            <td>@device.user_name</td>
                                                            <td><button style="background: forestgreen;border: 1px solid green;border-radius: 7px;" onclick="ViewImage('@device.device.image_TB','@device.device.note_status')">Xem</button></td>



                                                        </tr>
                                                    }
                                                    else
                                                    {
                                                        <tr>

                                                            <td scope="row">@dem3</td>
                                                            <td>@device.device.code_device</td>
                                                            <td style="text-align:left;">@device.device.device_name</td>
                                                            <td>@device.device.quantity</td>
                                                            <td>@device.device.price</td>
                                                            <td>@(device.device.brand != null ? device.device.brand.Trim() : "N/A")</td>

                                                            <td>@device.device.parameter</td>

                                                            <td>@(device.device.unit != null ? device.device.unit.Trim() : "N/A")</td>

                                                            <td>@(device.device.location != null ? device.device.location.Trim() : "N/A")</td>

                                                            <td>@(device.device.status == 1 ? "OK" : device.device.status == 2 ? "NG" : "N/A")</td>
                                                            <td>@(device.device.makiemke != null ? device.device.makiemke.Trim() : "N/A")</td>
                                                            <td>@(device.device.produce_SN != null ? device.device.produce_SN.Trim() : "N/A")</td>
                                                            <td>@(device.device.calibration != null ? device.device.calibration.Trim() : "N/A")</td>
                                                            @if (device.device.create_date != null)
                                                            {
                                                                <td>@device.device.create_date.Value.ToString("dd/MM/yyyy")</td>
                                                            }
                                                            else
                                                            {
                                                                <td>N/A</td>
                                                            }
                                                            @if (device.device.update_date != null)
                                                            {
                                                                <td>@device.device.update_date.Value.ToString("dd/MM/yyyy")</td>
                                                            }
                                                            else
                                                            {
                                                                <td>N/A</td>
                                                            }
                                                            <td>@(device.device.kind_of_device == 1 ? "TB CĐ" : device.device.kind_of_device == 2 ? "TB TH" : device.device.kind_of_device == 3 ? "TB DP" : "N/A")</td>
                                                            <td>@device.user_name</td>
                                                            <td><button style="background: forestgreen;border: 1px solid green;border-radius: 7px;" onclick="ViewImage('@device.device.image_TB','@device.device.note_status')">Xem</button></td>



                                                        </tr>
                                                    }
                                                }
                                            }
                                        </tbody>
                                    </table>
                                    <table hidden id="tbl3" class="table table-bordered" style="color:floralwhite;text-align:center;">
                                        <thead style="background:#5c7096;">
                                            <tr>
                                                <th scope="col" style="text-align:center;">STT</th>
                                                <th scope="col" style="text-align:center;width: 6.2%;">Mã TB</th>
                                                <th scope="col" style="text-align:center; width:14%">Tên TB</th>
                                                <th scope="col" style="text-align:center; width:4%">Số lượng</th>
                                                <th scope="col" style="text-align:center; width:4%;">Giá</th>
                                                <th scope="col" style="text-align:center; width:4%;">Nhãn hiệu</th>
                                                <th scope="col" style="text-align:center;width:14%;">Quy cách</th>
                                                <th scope="col" style="text-align:center;">Đơn vị</th>
                                                <th scope="col" style="text-align:center;">Vị trí</th>
                                                <th scope="col" style="text-align:center;">TT</th>
                                                <th scope="col" style="text-align:center; width:5%;">Kiểm kê</th>
                                                <th scope="col" style="text-align:center;">SN</th>
                                                <th scope="col" style="text-align:center; width:5%;">Hiệu chỉnh</th>
                                                <th scope="col" style="text-align:center; width:6%;">Ngày nhập</th>
                                                <th scope="col" style="text-align:center;width:6%;">Ngày update</th>
                                                <th scope="col" style="text-align:center;width:4%;">Loại TB</th>
                                                <th scope="col" style="text-align:center;width:4%;">Quản lý</th>
                                                <th scope="col" style="text-align:center;width:4%;">Hình ảnh</th>

                                            </tr>
                                        </thead>
                                        <tbody id="tbl4_id">
                                            @*@foreach (var device in Model)
                                                {
                                                    if (device.device.kind_of_device == 4)
                                                    {
                                                        { dem4++; }
                                                        if (device.device.quantity <= device.device.gioihan)
                                                        {
                                                <tr class="animation" style="background-color:#e6333394;">

                                                    <td scope="row">@dem</td>
                                                    <td>@device.device.code_device</td>
                                                    <td style="text-align:left;">@device.device.device_name</td>
                                                    <td>@device.device.quantity</td>
                                                    <td>@device.device.price</td>
                                                    <td>@(device.device.brand != null ? device.device.brand.Trim() : "N/A")</td>

                                                    <td>@device.device.parameter</td>

                                                    <td>@(device.device.unit != null ? device.device.unit.Trim() : "N/A")</td>

                                                    <td>@(device.device.location != null ? device.device.location.Trim() : "N/A")</td>

                                                    <td>@(device.device.status == 1 ? "OK" : device.device.status == 2 ? "NG" : "N/A")</td>
                                                    <td>@(device.device.makiemke != null ? device.device.makiemke.Trim() : "N/A")</td>
                                                    <td>@(device.device.produce_SN != null ? device.device.produce_SN.Trim() : "N/A")</td>
                                                    <td>@(device.device.calibration != null ? device.device.calibration.Trim() : "N/A")</td>
                                                    @if (device.device.create_date != null)
                                                    {
                                                        <td>@device.device.create_date.Value.ToString("dd/MM/yyyy")</td>
                                                    }
                                                    else
                                                    {
                                                        <td>N/A</td>
                                                    }
                                                    @if (device.device.update_date != null)
                                                    {
                                                        <td>@device.device.update_date.Value.ToString("dd/MM/yyyy")</td>
                                                    }
                                                    else
                                                    {
                                                        <td>N/A</td>
                                                    }
                                                    <td>@(device.device.kind_of_device == 1 ? "TB CĐ" : device.device.kind_of_device == 2 ? "TB TH" : device.device.kind_of_device == 3 ? "TB DP" : "N/A")</td>
                                                    <td>@device.user_name</td>
                                                    <td><button style="background: forestgreen;border: 1px solid green;border-radius: 7px;" onclick="ViewImage(@device.device.image_TB)">Xem</button></td>

                                                </tr>
                                                        }
                                                        else
                                                        {
                                                <tr>

                                                    <td scope="row">@dem</td>
                                                    <td>@device.device.code_device</td>
                                                    <td style="text-align:left;">@device.device.device_name</td>
                                                    <td>@device.device.quantity</td>
                                                    <td>@device.device.price</td>
                                                    <td>@(device.device.brand != null ? device.device.brand.Trim() : "N/A")</td>

                                                    <td>@device.device.parameter</td>

                                                    <td>@(device.device.unit != null ? device.device.unit.Trim() : "N/A")</td>

                                                    <td>@(device.device.location != null ? device.device.location.Trim() : "N/A")</td>

                                                    <td>@(device.device.status == 1 ? "OK" : device.device.status == 2 ? "NG" : "N/A")</td>
                                                    <td>@(device.device.makiemke != null ? device.device.makiemke.Trim() : "N/A")</td>
                                                    <td>@(device.device.produce_SN != null ? device.device.produce_SN.Trim() : "N/A")</td>
                                                    <td>@(device.device.calibration != null ? device.device.calibration.Trim() : "N/A")</td>
                                                    @if (device.device.create_date != null)
                                                    {
                                                        <td>@device.device.create_date.Value.ToString("dd/MM/yyyy")</td>
                                                    }
                                                    else
                                                    {
                                                        <td>N/A</td>
                                                    }
                                                    @if (device.device.update_date != null)
                                                    {
                                                        <td>@device.device.update_date.Value.ToString("dd/MM/yyyy")</td>
                                                    }
                                                    else
                                                    {
                                                        <td>N/A</td>
                                                    }
                                                    <td>@(device.device.kind_of_device == 1 ? "TB CĐ" : device.device.kind_of_device == 2 ? "TB TH" : device.device.kind_of_device == 3 ? "TB DP" : "N/A")</td>
                                                    <td>@device.user_name</td>
                                                    <td><button style="background: forestgreen;border: 1px solid green;border-radius: 7px;" onclick="ViewImage(@device.device.image_TB)">Xem</button></td>


                                                </tr>
                                                        }
                                                    }
                                                }*@
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

        </div>
    </div>
</div>
<div class="modal" id="ModalCreate_Receive">
    <div class="modal-dialog modal-sm" style="width: 900px;">
        <div class="modal-content" style="max-height:600px;overflow-y:auto;">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Create Order</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body">
                <input hidden id="receive_id" />
                <input hidden id="receive_back_id" />
                <div class="w3-bar w3-black">
                    <button class="w3-bar-item w3-button" onclick="show_tab('tblAddReceive')" style="background: #73ca24;border: 0px solid;height: 35px; border-radius: 10px;">Đơn lĩnh TB</button>
                    <button class="w3-bar-item w3-button" onclick="show_tab('tblBack')" style="background: #7fd0ff;border: 0px solid;height: 35px; border-radius: 10px;">Đơn trả kho</button>
                </div>
                <table class="table1" style="border:0;" id="tblAddReceive">
                    <tr>
                        <td style="width:150px;">Tên đơn: </td>
                        <td>
                            <input type="text" class="form-control TYPEDEVICE" style="background-color:white;color:black;border: 1px solid #5c7096;border-radius: 21px;width: 470px;" id="receive_name">
                        </td>
                    </tr>
                    <tr>
                        <td>Quản lý ký</td>
                        <td>
                            <select id="manager" class="form-control TYPEDEVICE" style="background-color: #ffffff;border: 1px solid #5c7096;border-radius: 27px;color: #333;">
                                <option value="0">Chọn quản lý</option>
                                @foreach (var item in listAllManager)
                                {
                                    <option value="@item.id">@item.fullname</option>
                                }
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>Ghi chú: </td>
                        <td><textarea type="text" class="form-control TYPEDEVICE" style="background-color:white;color:black;border: 1px solid #5c7096;border-radius: 21px;" id="receive_note"></textarea></td>
                    </tr>
                </table>
                <table class="table1" style="border:0;margin-left: 60px;font-size:1.5vh;" id="tblBack">
                    <tr>
                        <td style="width: 150px;height: 50px;">Mã SN: </td>
                        <td>
                            <input type="text" class="form-control TYPEDEVICE" style="background-color:white;color:black;border: 1px solid #5c7096;border-radius: 21px;width:10vw;font-size: 1.5vh;" id="maSN">
                        </td>
                        <td style="width: 150px;height: 50px;">Mã Kiểm kê: </td>
                        <td>
                            <input type="text" class="form-control TYPEDEVICE" style="background-color:white;color:black;border: 1px solid #5c7096;border-radius: 21px; width:10vw;font-size: 1.5vh;" id="makiemke">
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 150px;height: 50px;">Tên TB: </td>
                        <td>
                            <input type="text" class="form-control TYPEDEVICE" style="background-color:white;color:black;border: 1px solid #5c7096;border-radius: 21px;width:10vw;font-size: 1.5vh;" id="tenTB">
                        </td>
                        <td style="width: 150px;height: 50px;">Model: </td>
                        <td>
                            <input type="text" class="form-control TYPEDEVICE" style="background-color:white;color:black;border: 1px solid #5c7096;border-radius: 21px; width:10vw;font-size: 1.5vh;" id="model_TB">
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 150px;height: 50px;">Mã Hiệu chuẩn: </td>
                        <td>
                            <input type="text" class="form-control TYPEDEVICE" style="background-color:white;color:black;border: 1px solid #5c7096;border-radius: 21px; width:10vw;font-size: 1.5vh;" id="mahieuchuan">
                        </td>
                        <td style="width: 150px;height: 50px;">Nhập vào kho : </td>
                        <td>
                            <select id="kho_TB" class="form-control TYPEDEVICE" style="background-color:white;color:black;border: 1px solid #5c7096;border-radius: 21px;font-size: 1.5vh;">
                                <option value="0">Chọn kho</option>
                                <option value="1">Auto</option>
                                <option value="2">Arlo</option>
                                <option value="3">NetGear</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 150px;height: 50px;">Tình trạng TB: </td>
                        <td>
                            <select id="statusTB" class="form-control TYPEDEVICE" style="background-color:white;color:black;border: 1px solid #5c7096;border-radius: 21px;width:10vw;font-size: 1.5vh;">
                                <option value="0">Tình trạng TB</option>
                                <option value="1">OK</option>
                                <option value="2">NG</option>
                            </select>
                        </td>
                        <td style="width: 150px;height: 50px;">Ghi chú: </td>
                        <td><textarea type="text" class="form-control TYPEDEVICE" style="background-color:white;color:black;border: 1px solid #5c7096;border-radius: 21px;font-size: 1.5vh;" id="noteTB"></textarea></td>
                    </tr>
                    <tr></tr>
                    <tr class="image_TB">
                        <td style="width: 150px;height: 50px;">Hình ảnh nếu có: </td>
                        <td>
                            <input type="file" class="form-control TYPEDEVICE" style="background-color:white;color:black;border: 1px solid #5c7096;border-radius: 21px;width:10vw;font-size: 1.5vh;" id="imageTB" multiple>
                        </td>
                        <td style="width: 150px;height: 50px;">Quản lý ký</td>
                        <td>
                            <select id="quanly" class="form-control TYPEDEVICE" style="background-color: #ffffff;border: 1px solid #5c7096;border-radius: 27px;color: #333;font-size: 1.5vh;">
                                <option value="0">Chọn quản lý</option>
                                @*@foreach (var item in listAllManager)
                                    {
                                        <option value="@item.id">@item.fullname</option>
                                    }*@
                                <option value="1008">Attila</option>
                                <option value="1007">Tommy</option>
                                <option value="1022">BINJUN</option>
                                <option value="2176">Nguyễn Văn Tuấn</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td style="text-align:right;font-size: 1.5vh;"><button class="btn btn-secondary" style="color:white;background:green" onclick="CreateReceive()">Thêm</button></td>
                    </tr>
                </table>
                <div style="height:50vh;overflow:auto;" id="table-back">
                    <table id="table_View_Back" class="table table-bordered">
                        <thead style="background:wheat;font-size:1.5vh;">
                            <tr>
                                <th style="width:4%;">STT</th>
                                <th style="width:12%;">Mã SN</th>
                                <th style="width:12%;">Mã kiểm kê</th>
                                <th style="width:12%;">Tên TB</th>
                                <th style="width:12%;">Model</th>
                                <th style="width:10%;">Mã hiệu chuẩn</th>
                                <th style="width:5%;">Kho</th>
                                <th style="width:5%;">TT</th>
                                <th style="width:12%;">Ghi chú</th>
                                <th style="width:8%;">Ảnh</th>
                                <th style="width:8%;">Quản lý</th>
                            </tr>
                        </thead>
                        <tbody id="tbody_View" style="font-size:1.3vh;"></tbody>
                    </table>
                </div>

            </div>

            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary btnclose">Đóng</button>
               <button type="button" class="btn btn-secondary btnAdd" onclick="CreateReceive()">Tạo đơn</button>

            </div>

        </div>
    </div>
</div>
<!-- The Modal -->
<div class="modal" id="myModal">
    <div class="modal-dialog modal-sm" style="width:85vw">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Lĩnh TB</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body">
                <table style="border:0; width:100%;" id="tblAddDevice">
                    <thead>
                        <tr style="height:50px;">
                            <th style="width: 20%;">Tên TB</th>
                            <th style="width:6%;">Số lượng</th>
                            <th style="width: 6%;">Lĩnh</th>
                            <th style="width: 6%;">Đôi</th>
                            <th style="width: 6%;">Mượn</th>
                            <th style="width: 10%;">Ngày trả</th>
                            <th style="width:12%;">Ghi chú</th>
                            <th style="width:7%;">Hành động</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <select id="device_name" class="selectpicker Da_select_model form-control" data-hide-disabled="true" data-live-search="true">
                                    @foreach (var device in listAllDevice)
                                    {
                                    <option value="@device.id">
                                        @device.code_device-@device.device_name (@device.parameter) | Kho: @device.location Tồn kho: @device.quantity | @(device.status==1?"OK":"NG") | @device.produce_SN | @device.makiemke | @device.calibration | @device.create_date.Value.ToString("dd/MM/yyyy")
                                    </option>
                                    }
                                </select>
                            </td>
                            @*<td><input type="text" class="form-control TYPEDEVICE type_device" style="background-color:white;color:black;" id=""></td>*@
                            <td><input type="text" class="form-control QUANTITY quantity" style="background-color:white;color:black;" id=""></td>
                            <td><input type="radio" name="check" id="check_1" value="1" /></td>
                            <td><input type="radio" name="check" id="check_2" value="2" /></td>
                            <td><input type="radio" name="check" id="check_3" value="3" /></td>
                            <td><input type="date" class="form-control" id="ngaytra" style="width: 153px;"></td>
                            <td><textarea type="text" class="form-control NOTE note" style="background-color:white;color:black;" id=""></textarea></td>
                            <td style="text-align:center;">
                                <button onclick="Add_Device()" style="background: aquamarine;border: 1px solid;padding: 5px 15px 5px 15px;border-radius: 20px;">Thêm</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table class="table table-dark tblCreate">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>Tên TB</th>
                            <th>Kho</th>
                            <th>Số luợng</th>
                            <th>Type</th>
                            <th>Ghi chú</th>
                            @*<th>Action</th>*@
                        </tr>
                    </thead>
                    <tbody id="tblDevice" style="text-align:center;">
                        @*<tr>
                                <td><span>1</span></td>
                                <td>
                                    <select id="device_name" class="selectpicker Da_select_model form-control" data-hide-disabled="true" data-live-search="true">
                                        @foreach (var device in listAllDevice)
                                        {
                                            <option value="@device.id">@device.device_name</option>
                                        }
                                    </select>
                                </td>
                                <td><input type="text" class="form-control TYPEDEVICE type_device" style="background-color:white;color:black;" id=""></td>
                                <td><input type="text" class="form-control QUANTITY quantity" style="background-color:white;color:black;" id=""></td>
                                <td><input type="radio" name="check" id="check_1" value="1" /></td>
                                <td><input type="radio" name="check" id="check_2" value="2" /></td>
                                <td><input type="radio" name="check" id="check_3" value="3" /></td>
                                <td><input type="text" class="form-control NOTE note" style="background-color:white;color:black;" id=""></td>
                                <td style="text-align:center;">
                                    <a class="add_row" title="Add" data-toggle="tooltip">
                                        <i class="fa fa-plus"></i>
                                    </a>
                                </td>
                            </tr>*@
                    </tbody>
                </table>
            </div>

            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary btnComplete" style="background:green;color:white;">Complete</button>
            </div>

        </div>
    </div>
</div>
<div class="modal" id="myModal_Image">
    <div class="modal-dialog modal-sm">
        <div class="modal-content" style="">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Create New Device</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body" style="height:450px;">
                <input hidden id="id_device" />

                <div id="imageTB"> </div>
                <h5>Note: </h5>
                <textarea id="note_status" disabled style="border: 1px solid #80808082;color: red;background: #9ddaec4d;width: 850px;height: 50px;border-radius: 5px;"></textarea>
            </div>

            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary btnclose">Đóng</button>
            </div>
        </div>
    </div>
</div>
<script>
    var tab = "tbl";
    function show_table(id_table) {
        var i;
        var x = document.getElementsByClassName("table");
        for (i = 0; i < x.length; i++) {
            x[i].style.display = "none";
        }
        document.getElementById(id_table).style.display = "block";
        tab = id_table;
    }
    var check = 0;
    document.getElementById("table_View_Back").style.display = "none";
    function show_tab(id_table) {
        var i;
        var x = document.getElementsByClassName("table1");
        for (i = 0; i < x.length; i++) {
            x[i].style.display = "none";
        }
        if (id_table == "tblBack") {
            document.getElementById("table_View_Back").style.display = "block";
            document.getElementById("table-back").style.display = "block";
        } else {
            document.getElementById("table_View_Back").style.display = "none";
            document.getElementById("table-back").style.display = "none";
        }
        document.getElementById(id_table).style.display = "block";
        if (id_table == "tblAddReceive") {
            check = 1;
            $(".btnAdd").show();
        } else {
            check = 2;
            $(".btnAdd").hide();
        }
        console.log(check);
    }
    function fnExcelReport() {
        debugger
        var tab_text = "<table border='2px'><tr bgcolor='#87AFC6'>";
        var textRange; var j = 0;
        tab = document.getElementById('tbl'); // id of table

        for (j = 0; j < tab.rows.length; j++) {
            tab_text = tab_text + tab.rows[j].innerHTML + "</tr>";
            //tab_text=tab_text+"</tr>";
        }

        tab_text = tab_text + "</table>";
        /*tab_text = tab_text.replace(/<A[^>]*>|<\/A>/g, "");*///remove if u want links in your table
        /* tab_text = tab_text.replace(/<img[^>]*>/gi, "");*/ // remove if u want images in your table
        tab_text = tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

        var ua = window.navigator.userAgent;
        var msie = ua.indexOf("MSIE ");

        if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))      // If Internet Explorer
        {
            txtArea1.document.open("txt/html", "replace");
            txtArea1.document.write(tab_text);
            txtArea1.document.close();
            txtArea1.focus();
            sa = txtArea1.document.execCommand("SaveAs", true, "List All Devices.xls");
        }
        else                 //other browser not tested on IE 11
            //sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));
            var a = document.createElement('a');
        a.href = 'data:application/vnd.ms-excel,' + encodeURIComponent(tab_text);
        a.download = "List All Devices.xls";
        a.click();

        return (sa);
    }
    var select_value = 0;
    $(document).ready(function () {
        show_tab('tblAddReceive');
        function search() {
            $("#input_search").on("keyup", function () {
                //get the input value, trimmed, and lowercased
                var value = this.value.trim().toLowerCase();
                //get the associated table
                var $table;
                if (tab == "tbl") {
                    $table = $("#tbl_id");
                } else if (tab == "tbl1") {
                    $table = $("#tbl1_id");
                } else if (tab == "tbl2") {
                    $table = $("#tbl2_id");
                } else if (tab == "tbl3") {
                    $table = $("#tbl3_id");
                } else if (tab == "tbl4") {
                    $table = $("#tbl3_id");
                }


                //show all the rows to "undo" previous filtering
                $table.find('tr').show();

                //only filter if the value is not blank
                if (value) {
                    $table.find('thead tr').show();
                    //find all the rows that do not match the filter, and hide them
                    $table.find('tr').filter(function () {

                        return this.innerText.toLowerCase().indexOf(value) < 0;
                    }).hide();
                }
            });
        };
        search();
        //$("#tenTB").prop('disabled', true);
        //$("#model_TB").prop('disabled', true);
        //$("#mahieuchuan").prop('disabled', true);
        //$("#tenTB").css({ "background": "#d6d2d2" });
        //$("#model_TB").css({ "background": "#d6d2d2" });
        //$("#mahieuchuan").css({ "background": "#d6d2d2" });
        $("#maSN").focusout(function () {
            if ($("#maSN").val() != "") {
                maSN = document.getElementById("maSN").value;
            } else {
                alert("Vui lòng nhập mã SN!");
                return;
            }
            $.ajax({
                type: "Post",
                url: "/Device/check_SN?maSN=" + maSN,
                async: false,
                contentType: false,
                processData: false,
                success: function (data) {

                    if (data == "NG") {
                        //alert("Mã SN k đúng!");
                        $("#tenTB").val("");
                        $("#model_TB").val("");
                        $("#mahieuchuan").val("");
                        $("#makiemke").val("");
                        $("#kho_TB").prop('disabled', false);
                        $("#kho_TB").val(0);
                        $("#kho_TB option:selected").text("Chọn kho");
                        $("#kho_TB").css({ "background-color": "white" });
                        $("#tenTB").prop('disabled', false);
                        $("#tenTB").css({ "background-color": "white" });
                        $("#model_TB").val("");
                        $("#model_TB").prop('disabled', false);
                        $("#model_TB").css({ "background-color": "white" });
                        $("#mahieuchuan").val("");
                        $("#mahieuchuan").prop('disabled', false);
                        $("#mahieuchuan").css({ "background-color": "white" });
                        $("#makiemke").val("");
                        $("#makiemke").prop('disabled', false);
                        $("#makiemke").css({ "background-color": "white" });
                        $(".btn").prop('disabled', false);
                        $(".btnclose").css({ "background": "red" });
                        $(".btnAdd").css({ "background": "green" });
                    } else {
                        $("#tenTB").val(JSON.parse(data).tenTB);
                        $("#model_TB").val(JSON.parse(data).model_TB);
                        if (JSON.parse(data).maHC == "null") {
                            $("#mahieuchuan").val("");
                        } else {
                            $("#mahieuchuan").val(JSON.parse(data).maHC);
                        }
                        debugger
                        if (JSON.parse(data).makiemke == "null") {
                            $("#makiemke").val("");
                        } else {
                            $("#makiemke").val(JSON.parse(data).makiemke);
                        }
                        if (JSON.parse(data).kho_TB != "null") {
                            $("#kho_TB option:selected").text(JSON.parse(data).kho_TB);
                            var number = 0;
                            if (JSON.parse(data).kho_TB == "null") {
                                number = 0;
                            } else if (JSON.parse(data).kho_TB == "Auto") {
                                number = 1;
                            } if (JSON.parse(data).kho_TB == "Arlo") {
                                number = 2;
                            } if (JSON.parse(data).kho_TB == "null") {
                                number = 3;
                            }
                            $("#kho_TB").val(number);
                            $("#kho_TB").prop('disabled', true);
                            $("#kho_TB").css({ "background": "#d6d2d2" });
                        } else {
                            $("#kho_TB").val(0);
                            $("#kho_TB option:selected").text("Chọn kho");
                            $("#kho_TB").prop('disabled', false);
                            $("#kho_TB").css({ "background": "white" });
                        }
                        $("#tenTB").prop('disabled', true);
                        $("#model_TB").prop('disabled', true);
                        $("#mahieuchuan").prop('disabled', true);
                        $("#makiemke").prop('disabled', true);
                        $("#tenTB").css({ "background": "#d6d2d2" });
                        $("#model_TB").css({ "background": "#d6d2d2" });
                        $("#mahieuchuan").css({ "background": "#d6d2d2" });
                        $("#makiemke").css({ "background": "#d6d2d2" });
                        $(".btn").prop('disabled', false);
                        $(".btn").css({ "background": "rgba(255, 255, 255, .1)" });
                        $(".btnclose").css({ "background": "red" });
                        $(".btnAdd").css({ "background": "green" });


                    }
                },
                error: function (err) {
                    //debugger
                    alert("FAIL!");
                }
            });
        });
        //$('#statusTB').on('change', function () {
        //    select_value = this.value;
        //    if (select_value == "2") {
        //        $("#image_TB").show();
        //    }
        //});
    })
    var modal = document.getElementById("myModal");
    var modal_CreateReceive = document.getElementById("ModalCreate_Receive");
    var modal_Image = document.getElementById("myModal_Image");
    $(document).on("click", ".close", function () {
        modal.style.display = "none";
        modal_CreateReceive.style.display = "none";
        modal_Image.style.display = "none";
        location.reload();
    })
    $(document).on("click", ".btnclose", function () {
        modal.style.display = "none";
        modal_CreateReceive.style.display = "none";
        modal_Image.style.display = "none";
    })
    $(document).on("click", ".btnComplete", function () {
        modal.style.display = "none";
        //location.reload();
    })
    function open_Modal_Create() {
        //alert("OK");
        modal_CreateReceive.style.display = "block";
    }
    $("#receive_back_id").val("");
    function CreateReceive() {
        if (check == 1) {
            var receive_name;
            if ($("#receive_name").val() != 0) {
                receive_name = document.getElementById("receive_name").value;
            } else {
                alert("Vui lòng điền tên đơn!");
                return;
            }
            var manager_name;
            var manager_id;
            if ($("#manager").val() != 0) {
                manager_id = $("#manager").val();
                manager_name = $("#manager option:selected").text();
            } else {
                alert("Vui lòng chọn người kí!");
                return;
            }

            var note;
            if ($("#receive_note").val() != 0) {
                note = document.getElementById("receive_note").value;
            } else {
                note = "";
            }
            var data = new FormData;
            debugger
            data.append("receive_name", receive_name);
            data.append("manager_name", manager_name);
            data.append("manager_id", manager_id);
            data.append("note", note);

            $.ajax({
                type: "Post",
                url: "/Receive/Create_Receive",
                data: data,
                async: false,
                contentType: false,
                processData: false,
                success: function (data) {
                    debugger
                    //get_Device_Receive(int.parse(data));
                    $("#receive_id").val(parseInt(data));

                    modal_CreateReceive.style.display = "none";
                    modal.style.display = "block";
                },
                error: function (err) {
                    //debugger
                    alert("FAIL!");
                }
            });
        } else if (check == 2) {
            var receive_id = $("#receive_back_id").val();
            var makiemke;
            if ($("#makiemke").val() != "") {
                makiemke = document.getElementById("makiemke").value;
            } else {
                alert("Vui lòng nhập mã kiểm  kê!");
                //$("#makiemke").css({ "border-color": "red" });
                return;
            }
            var maSN;
            maSN = document.getElementById("maSN").value;

            var tenTB;
            if ($("#tenTB").val() != "") {
                tenTB = document.getElementById("tenTB").value;
            } else {
                alert("Vui lòng nhập tên TB!");
                return;
            }
            var mahieuchuan;
            if ($("#mahieuchuan").val() != "") {
                mahieuchuan = document.getElementById("mahieuchuan").value;
            } else {
                mahieuchuan = "";
            }
            var model_TB;
            if ($("#model_TB").val() != "") {
                model_TB = document.getElementById("model_TB").value;
            } else {
                alert("Vui lòng nhập Model TB!");
                //$("#model_TB").css({ "border-color": "red" });
                return;
            }
            var statusTB;

            var kho_TB;
            if ($("#kho_TB").val() != 0) {
                kho_TB = $("#kho_TB option:selected").text();
            } else {
                alert("Vui lòng chọn Kho!");
                return;
            }

            if ($("#statusTB").val() != 0) {
                statusTB = $("#statusTB").val();
                //if (statusTB == 2) {

                //} else {
                //    if ($("#imageTB").get(0).files.length != 0) {
                //        imageTB = $("#imageTB").get(0).files;
                //    } else {
                //        imageTB = "";
                //    }
                //}
            } else {
                alert("Vui lòng chọn Tình trạng TB!");
                //$("#statusTB").css({ "border-color": "red" });
                return;
            }
            var imageTB;
            if ($("#imageTB").get(0).files.length != 0) {
                imageTB = $("#imageTB").get(0).files;
            } else {
                alert("Vui lòng chọn hình ảnh Thiết bị!");
                //$("#imageTB").css({ "border-color": "red" });
                return;
            }

            var noteTB;
            if ($("#noteTB").val() != "") {
                noteTB = document.getElementById("noteTB").value;
            } else {
                noteTB = "";
            }
            var quanly;
            var quanly_id;
            if ($("#quanly").val() != 0) {
                quanly_id = $("#quanly").val();
                quanly = $("#quanly option:selected").text();
            } else {
                alert("Vui lòng chọn Quản lý ký!");
                //$("#quanly").css({ "border-color": "red" });
                return;
            }
            var data1 = new FormData;
            data1.append("receive_id", receive_id);
            data1.append("makiemke", makiemke);
            data1.append("maSN", maSN);
            data1.append("tenTB", tenTB);
            data1.append("model_TB", model_TB);
            data1.append("kho_TB", kho_TB);
            data1.append("statusTB", statusTB);
            if (imageTB != "") {
                for (var i = 0; i < imageTB.length; i++) {
                    data1.append(`imageTB[${i}]`, imageTB[i]);
                }
            } else {
                data1.append("imageTB", imageTB);
            }
            data1.append("noteTB", noteTB);
            data1.append("quanly", quanly);
            data1.append("quanly_id", quanly_id);
            data1.append("calibration", mahieuchuan);
            debugger
            $.ajax({
                type: "Post",
                url: "/Device/Device_Back_Room",
                data: data1,
                async: false,
                contentType: false,
                processData: false,
                success: function (data) {
                    debugger
                    if (data != "NG") {
                        alert("Tạo đơn thành công!");
                        $("#quanly").disable = true;
                        $("#receive_back_id").val(parseInt(data));
                        loadTableBack(parseInt(data));
                        //location.reload();
                    } else {
                        alert("Tạo đơn k thành công!");
                    }
                },
                error: function (err) {
                    //debugger
                    alert("FAIL!");
                }
            });
        }
    }
    function loadTableBack(receive_id) {
        $.ajax({
            type: "Post",
            url: "/Device/getDataBackDevice?receive_id=" + receive_id,
            async: false,
            contentType: false,
            processData: false,
            success: function (data) {
                var length_array = JSON.parse(data).length;
                var row = "";
                if (length_array > 0) {
                    for (i = 0; i < length_array; i++) {
                        var image = "";
                        if (JSON.parse(data)[i].deviceBack.imageTB != null) {
                            image = "N/A";
                        } else {
                            var image_ = JSON.parse(JSON.parse(data)[i].deviceBack.image_TB);
                            var list_image = "";
                            for (j = 0; j < image_.length; j++) {
                                list_image += '<a href="/Data/Image/' + image_[j].file + '" data-toggle="lightbox" data-max-width="600" >' +
                                    '   <img style="width:150px;height:100px;border: 1px solid #2c303a" src="/Data/Image/' + image_[j].file + '" class="img-fluid">' +
                                    '</a>';
                            }
                            image = list_image;
                        }
                        row = row + '<tr>' +
                                    '<td><span>' + (i + 1) + '</span></td></td>' +
                                    '<td>' + JSON.parse(data)[i].deviceBack.produce_SN + '</td>' +
                                    '<td>' + JSON.parse(data)[i].deviceBack.makiemke + '</td>' +
                                    '<td>' + JSON.parse(data)[i].deviceBack.device_name + '</td>' +
                                    '<td>' + JSON.parse(data)[i].deviceBack.parameter + '</td>' +
                                    '<td>' + JSON.parse(data)[i].deviceBack.calibration + '</td>' +
                                    '<td>' + JSON.parse(data)[i].deviceBack.location + '</td>' +
                                    '<td>' + (JSON.parse(data)[i].deviceBack.status == 1 ? "OK" : "NG") + '</td>' +
                                    '<td>' + JSON.parse(data)[i].deviceBack.note_status + '</td>' +
                                    '<td>' + image + '</td>' +
                                    '<td>' + JSON.parse(data)[i].username + '</td>' +
                                    '</tr>';
                    }
                } else {
                    row = '<tr><td colspan="11" style="text-align:center;">--------No Data-------</td></tr>';
                }
                $("#tbody_View").empty();
                $("#tbody_View").append(row);
            },
            error: function (err) {
                //debugger
                alert("FAIL!");
            }
        });
    }
    var stt_global = 1;

    function Add_Device() {
        debugger
        var receive_id = document.getElementById("receive_id").value;
        var device_id;
        if ($("#device_name").val() != 0) {
            device_id = $("#device_name").val();
            //alert(device_id);
        } else {
            alert("Pls Enter Device Name!");
            return;
        }
        var quantity;
        if ($(".quantity").val() != 0) {
            debugger
            quantity = $(".quantity").val();
            //var a = check_Quantity(device_id, $(".quantity").val());
            //alert(a + "      nam");
            $.ajax({
                type: "Post",
                url: "/Device/check_Quantity?device_id=" + device_id + "&quantity=" + quantity,
                async: false,
                cache: false,
                timeout: 30000,
                contentType: false,
                processData: false,
                success: function (data) {
                    debugger
                    var a = data;
                    // return data;

                    if (a == "0") {
                        alert("Quantity is too large!");
                        return;
                    } else {
                        quantity = $(".quantity").val();
                        //var unit;
                        //if ($(".type_device").val() != 0) {
                        //    unit = $(".type_device").val();
                        //} else {
                        //    alert("Pls Enter Type Of Device!");
                        //    return;
                    }

                    var check = 0;
                    var ngaytra;
                    if ($("input[name=check]:checked").val() != undefined) {
                        debugger
                        check = $("input[name=check]:checked").val();

                        if (check == 3) {
                            if ($("#ngaytra").val() != "") {
                                ngaytra = document.getElementById("ngaytra").value;
                            } else {
                                alert("Vui lòng chọn ngày trả TB cho kho!");
                                return;
                            }
                        } else {
                            ngaytra = "";
                        }
                    } else {
                        alert("Bạn muốn Lĩnh/Đổi/Mượn?");
                        return;
                    }
                    var note;
                    if ($(".note").val() != 0) {
                        note = $(".note").val();
                    } else {
                        note = "";
                    }
                    var data = new FormData;
                    data.append("id", 0);
                    data.append("receive_id", receive_id);
                    data.append("device_id", device_id);
                    //data.append("unit", unit);
                    data.append("quantity", quantity);
                    data.append("type", check);
                    data.append("note", note);
                    data.append("ngaytra", ngaytra);
                    $.ajax({
                        type: "Post",
                        url: "/Receive/Add_Device",
                        data: data,
                        async: false,
                        contentType: false,
                        processData: false,
                        success: function (data) {
                            debugger
                            if (data > 0) {
                                $(".type_device").empty();
                                $(".quantity").empty();
                                $(".note").empty();
                                get_Device_Receive(parseInt(data));
                            }
                        },
                        error: function (err) {
                            //debugger
                            alert("FAIL!");
                        }
                    });
                },
                error: function (err) {
                    debugger
                    alert("FAIL!");
                }
            });




            //if (a == "Quantity is too large!") {
            //    alert("Quantity is too large!");
            //    return;
            //} else {
            //    quantity = $(".quantity").val();
            //}
        } else {
            alert("Pls Enter Quantity Of Device!");
            return;
        }



    }
    function get_Device_Receive(receive_id) {
        $("#tblDevice").empty();
        $.ajax({
            type: "Post",
            url: "/Device/get_Device_Receive?receive_id=" + receive_id,
            async: false,
            contentType: false,
            processData: false,
            success: function (data) {
                //alert(data);
                debugger
                var the = '<a class="add_row" title="Add" data-toggle="tooltip"><i class="fa fa-plus"></i></ a>';
                var index = $("table tbody tr:last-child").index();
                if (JSON.parse(data).length > 0) {
                    var length_array = JSON.parse(data).length;
                    var data_ok = JSON.parse(data);
                    var option = '';
                    //for (i = 0; i < length_array; i++) {
                    //    option = option + '<option value="' + data_ok[i].id + '">' + data_ok[i].device_name.trim()+'</option>';
                    //}
                    //$('head').append('<link href="/Assets/admin/bootstrap-select.css" rel="stylesheet" />');
                    var row = "";
                    for (i = 0; i < length_array; i++) {
                        var type = "";
                        var note = "";
                        if (data_ok[i].clipOutput.type == 1) {
                            type = "Receive";
                        } else if (data_ok[i].clipOutput.type == 2) {
                            type = "Change";
                        } else if (data_ok[i].clipOutput.type == 3) {
                            type = "Borrow";
                        }
                        if (data_ok[i].clipOutput.note == null) {
                            note = "";
                        } else {
                            note = data_ok[i].clipOutput.note;
                        }
                        row = row + '<tr>' +
                            '<td><span>' + (i + 1) + '</span></td>' +
                            //'<td>' + data_ok[i].code_device +
                            '</td>' +
                            '<td>' + data_ok[i].device_name +
                            '</td>' +
                            '<td>' + data_ok[i].location + '</td>' +
                            '<td>' + data_ok[i].clipOutput.quantity + '</td>' +
                            '<td>' + type + '</td>' +
                            '<td>' + note + '</td>' +
                            '</tr>';
                        stt_global++;
                    }
                    $("#tblDevice").append(row);
                    //$('body').append('<link href="/Assets/admin/bootstrap-select.css" rel="stylesheet" />');

                    $("table tbody tr").eq(index + 1).find(".add, .edit").toggle();
                    $('[data-toggle="tooltip"]').tooltip();

                }
            },
            error: function (err) {
                //debugger
                alert("FAIL!");
            }
        });
    }
    //Check Quantity Of Device
    function check_Quantity(device_id, quantity) {
        $.ajax({
            type: "Post",
            url: "/Device/check_Quantity?device_id=" + device_id + "&quantity=" + quantity,
            async: false,
            cache: false,
            timeout: 30000,
            contentType: false,
            processData: false,
            success: function (data) {
                debugger
                a = data
                return data;
            },
            error: function (err) {
                debugger
                alert("FAIL!");
            }
        });
    }
    function ViewImage(imageTB, note_status) {
        if (imageTB != "") {
            $("#imageTB").empty();
            $("#note_status").empty();
            debugger
            var list_image = "";
            var image = JSON.parse(imageTB);
            for (j = 0; j < image.length; j++) {
                list_image += '<a href="/Data/Image/' + image[j].file + '" data-toggle="lightbox" data-max-width="600" >' +
                    '   <img style="width:50%;height:70%;border: 1px solid #2c303a;float:left;" src="/Data/Image/' + image[j].file + '" class="img-fluid">' +
                    '</a>';
            }
            $("#imageTB").append(list_image);
            $("#note_status").append(note_status);
            modal_Image.style.display = "block";
        } else {
            alert("TB này k có hình ảnh!");
        }
    }
</script>

